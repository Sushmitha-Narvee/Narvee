<div class="project-card">
  <div class="project-selector-container">
    <div class="custom-dropdown-wrapper">

      <!-- Project Dropdown -->
      <div class="custom-select" #projectDropdown (click)="toggleDropdown()" [class.open]="dropdownOpen">
        <div class="selected-option-wrapper">
          <div class="selected-option">{{ getSelectedProjectName() || 'Select Project' }}</div>
          <span class="dropdown-icon" [class.rotate]="dropdownOpen">&#9662;</span>
        </div>
        <ul class="options-list" *ngIf="dropdownOpen">
          <li *ngFor="let project of projects" (click)="selectProject(project.pid); $event.stopPropagation();"
            [class.selected]="selectedProject === project.pid">
            {{ project.projectname }}
          </li>
        </ul>
      </div>

    </div>

    <!-- Time Interval Dropdown -->
    <div class="custom-dropdown-wrapper" style="max-width: 200px;">
      <div class="custom-select"  #intervalDropdown (click)="toggleIntervalDropdown()" [class.open]="intervalDropdownOpen">
        <div class="selected-option-wrapper">
          <div class="selected-option">{{ selectedInterval || 'Select Interval' }}</div>
          <span class="dropdown-icon" [class.rotate]="intervalDropdownOpen">&#9662;</span>
        </div>
        <ul class="options-list" *ngIf="intervalDropdownOpen">
          <li *ngFor="let interval of timeIntervals" (click)="onGlobalFilterSelect(interval); $event.stopPropagation();"
            [class.selected]="selectedInterval === interval">
            {{ interval | titlecase }}
          </li>
        </ul>
      </div>
    </div>

  </div>
</div>



<div class="card-container">
  <mat-card *ngFor="let card of cards" class="dashboard-card">
    <div class="card-header">
      <div class="dot"></div>
      <span class="title">{{ card.title }}</span>
    </div>
    <div class="count">{{ card.count }}</div>
    <div class="description">{{ card.description }}</div>
  </mat-card>
</div>



<div class="dashboard-container ">
  <div class="chart-card">
    <div class="chart-header" style="display: flex; align-items: center; gap: 16px;">
      <h3 class="chart-title">{{ intervalTitle }}</h3>

      <!-- Custom Interval Label Dropdown (for daily/weekly/monthly only) -->
      <div class="custom-selectInterval"  #intervalLabelDropdown  *ngIf="intervalLabels.length && selectedInterval !== 'yearly'"
        (click)="toggleIntervalLabelDropdown()" [class.open]="intervalLabelDropdownOpen"
        style="min-width: 220px; position: relative;">
        <div class="selected-option-wrapper">
          <div class="selected-option">{{ selectedIntervalLabel || 'Select Range' }}</div>
          <span class="dropdown-icon" [class.rotate]="intervalLabelDropdownOpen">&#9662;</span>
        </div>

        <ul class="options-list" *ngIf="intervalLabelDropdownOpen">
          <li *ngFor="let label of intervalLabels" (click)="selectIntervalLabel(label); $event.stopPropagation();"
            [class.selected]="selectedIntervalLabel === label">
            {{ label }}
          </li>
        </ul>
      </div>
    </div>



    <span class="sideheading">Track task progress and completion rates over time </span>
    <div class="chart-wrapper">
      <canvas baseChart [data]="{ labels: chartLabels, datasets: chartData }" [options]="chartOptions" [type]="'bar'">
      </canvas>

    </div>
  </div>


  <!-- Right: Task Summary with Doughnut -->
  <div class="summary-card">
    <h3 class="summary-title">Task Distribution & Activity</h3>
    <span class="summary-subtitle">Monitor Task Status</span>

    <div class="priority-status">
      <div class="priority-item">
        <span class="priority-label high">High Priority</span>
        <span class="priority-count">{{ highPriorityCount }}</span>
      </div>
      <div class="priority-item">
        <span class="priority-label medium">Medium Priority</span>
        <span class="priority-count">{{ mediumPriorityCount }}</span>
      </div>
      <div class="priority-item">
        <span class="priority-label low">Low Priority</span>
        <span class="priority-count">{{ lowPriorityCount }}</span>
      </div>

    </div>

    <div class="doughnut-wrapper">
      <canvas baseChart [data]="doughnutData" [options]="doughnutOptions" [type]="'doughnut'">
      </canvas>
    </div>
  </div>

</div>
<div class="team-tracker">
  <div style="margin-left: 19px;">
    <h3 class="team-title">Team Performance Tracker</h3>
    <span class="team-subtitle">Monitor task assignments and team workload</span>
  </div>

  <div class="table-wrapper">
    <div class="responsive-table-wrapper fixed-height-scroll-container">

      <table mat-table [dataSource]="teamData" class="mat-elevation-z2 full-width-table">

        <!-- S.No Column -->
        <ng-container matColumnDef="sno">
          <th mat-header-cell *matHeaderCellDef>S.No</th>
          <td mat-cell *matCellDef="let element">{{ element.sno }}</td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let element">{{ element.fullname | titlecase }}</td>
        </ng-container>

        <!-- Assigned Column -->
        <ng-container matColumnDef="assigned">
          <th mat-header-cell *matHeaderCellDef>Assigned</th>
          <td mat-cell *matCellDef="let element">{{ element.Assigned }}</td>
        </ng-container>

        <!-- Completed Column -->
        <ng-container matColumnDef="completed">
          <th mat-header-cell *matHeaderCellDef>Completed</th>
          <td mat-cell *matCellDef="let element">{{ element.Completed }}</td>
        </ng-container>

        <!-- Ongoing Column -->
        <ng-container matColumnDef="ongoing">
          <th mat-header-cell *matHeaderCellDef>Ongoing</th>
          <td mat-cell *matCellDef="let element">{{ element.Ongoing }}</td>
        </ng-container>

        <!-- Overdue Column -->
        <ng-container matColumnDef="overdue">
          <th mat-header-cell *matHeaderCellDef>Overdue</th>
          <td mat-cell *matCellDef="let element">{{ element.Overdue }}</td>
        </ng-container>
        <!-- blccked Column -->
        <ng-container matColumnDef="blocked">
          <th mat-header-cell *matHeaderCellDef>Blocked</th>
          <td mat-cell *matCellDef="let element">{{ element.blocked }}</td>
        </ng-container>
        <!-- Position Column -->
        <ng-container matColumnDef="position">
          <th mat-header-cell *matHeaderCellDef>Position</th>
          <td mat-cell *matCellDef="let element">{{ element.position | titlecase }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="teamColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: teamColumns;"></tr>
      </table>
    </div>
  </div>
</div>